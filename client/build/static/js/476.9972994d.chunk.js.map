{"version":3,"file":"static/js/476.9972994d.chunk.js","mappings":"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","sources":["pages/User.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Link, useParams } from \"react-router-dom\";\nimport { useAppState, useUser } from \"../hooks/Hooks\";\n\nfunction User() {\n  const { username } = useParams();\n\n  const { user, dispatchUser } = useUser();\n  const [otherUser, setOtherUser] = useState(null);\n  const [error, setError] = useState(false);\n\n  useEffect(() => {\n    const fetchUser = async () => {\n      dispatchUser({ type: \"LOADING\" });\n      try {\n        const res = await fetch(\n          `http://localhost:5000/api/v1/users/${username}`,\n          {\n            method: \"GET\",\n            headers: {\n              Accept: \"application/json\",\n            },\n          }\n        );\n\n        const result = await res.json();\n\n        if (res.status === 404) {\n          window.location.href = \"/404\";\n        } else if (!result.success) {\n          throw new Error(result.error);\n        } else if (user.username === result.data.username) {\n          window.location.href = \"/profile\";\n        } else {\n          setOtherUser(result.data);\n        }\n      } catch (error) {\n        setError(true);\n        console.log(\"Error getting single user\", error);\n      } finally {\n        dispatchUser({ type: \"ERROR\" });\n      }\n    };\n    // dispatchUser({ type: \"LOADING\" });\n    fetchUser();\n  }, []);\n\n  const handleFollow = async () => {\n    const token = JSON.parse(localStorage.getItem(\"user\")).token;\n    try {\n      const res = await fetch(\n        `http://localhost:5000/api/v1/users/${username}/follow`,\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Accept: \"application/json\",\n            Authorization: `Bearer ${token}`,\n          },\n        }\n      );\n\n      const result = await res.json();\n      console.log(result);\n\n      if (res.ok) {\n        setOtherUser((prevState) => ({\n          ...prevState,\n          followers: [...prevState.followers, user?.id],\n        }));\n        console.log(user?.id);\n      } else {\n        throw new Error(\"Couldn't perform action\");\n      }\n    } catch (errror) {\n      console.log(error);\n    }\n  };\n\n  const handleUnfollow = async () => {\n    const token = JSON.parse(localStorage.getItem(\"user\")).token;\n    try {\n      const res = await fetch(\n        `http://localhost:5000/api/v1/users/${username}/follow`,\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Accept: \"application/json\",\n            Authorization: `Bearer ${token}`,\n          },\n        }\n      );\n\n      if (res.ok) {\n        setOtherUser((prevState) => ({\n          ...prevState,\n          followers: prevState.followers.filter(\n            (follower) => follower !== user.id\n          ),\n        }));\n      } else {\n        throw new Error(\"Couldn't perform actionr\");\n      }\n    } catch (errror) {\n      console.log(error);\n    }\n  };\n\n  return error ? (\n    <p className=\"mt-20 text-center\">Something went wrong. Try again later.</p>\n  ) : (\n    user && (\n      <div className=\"space-y-3 mt-20\">\n        <div className=\"h-20 w-20 rounded-full bg-gray-500 mx-auto\"></div>\n        <div className=\"flex justify-center gap-2 items-center\">\n          <p className=\"text-center font-semibold text-xl\">\n            {otherUser?.username}\n          </p>{\" \"}\n          {otherUser?.followers.includes(user.id) ? (\n            <button\n              onClick={handleUnfollow}\n              className=\"p-2 bg-gray-300 rounded-lg\"\n            >\n              Following\n            </button>\n          ) : (\n            <button\n              onClick={handleFollow}\n              className=\"p-2 bg-gray-300 rounded-lg\"\n            >\n              Follow\n            </button>\n          )}\n        </div>\n        <div className=\"flex gap-3 justify-center font-semibold text-xl\">\n          <div className=\"flex flex-col gap-2 items-center\">\n            <span>{otherUser?.followers.length}</span>\n            <span>Followers</span>\n          </div>\n          <div className=\"flex flex-col gap-2 items-center\">\n            <span>{otherUser?.following.length}</span>\n            <span>Following</span>\n          </div>\n        </div>\n      </div>\n    )\n  );\n}\n\nexport default User;\n"],"names":["username","useParams","user","dispatchUser","useUser","otherUser","setOtherUser","useState","error","setError","useEffect","async","type","res","fetch","concat","method","headers","Accept","result","json","status","window","location","href","success","Error","data","console","log","fetchUser","_jsx","className","children","_jsxs","followers","includes","id","onClick","token","JSON","parse","localStorage","getItem","Authorization","ok","prevState","_objectSpread","filter","follower","errror","length","following"],"sourceRoot":""}